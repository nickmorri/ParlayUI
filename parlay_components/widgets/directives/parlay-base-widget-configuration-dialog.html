<md-dialog aria-label="Parlay Widget Configuration Dialog" flex="90" flex-gt-md="70" ng-class="{'md-dialog-fullscreen' : $mdMedia}">
    <md-dialog-content>
        <md-tabs md-stretch-tabs="always" md-dynamic-height="true" class="md-primary">
            <md-tab>
                <md-tab-label>Template</md-tab-label>
                <md-tab-body>
                    <div layout="row">

                        <md-input-container flex>
                            <md-select ng-model="template" placeholder="Select a template">
                                <md-option ng-value="template_option.template" ng-repeat="template_option in dialogCtrl.getTemplates()">
                                    {{template_option.template}} ({{template_option.type}})
                                </md-option>
                            </md-select>
                        </md-input-container>

                    </div>
                </md-tab-body>
            </md-tab>
            <md-tab>
                <md-tab-label>Source</md-tab-label>
                <md-tab-body>
                    <div ng-controller="ParlayBaseWidgetConfigurationSourceController as sourceCtrl">

                        <md-chips ng-model="selectedItems" md-autocomplete-snap="" md-require-match="true">
                            <md-autocomplete
                                    md-min-length="0"
                                    md-select-on-match="true"
                                    md-match-case-insensitive="true"
                                    md-no-cache="true"
                                    md-search-text="sourceCtrl.searchText"
                                    md-items="item in sourceCtrl.querySearch(sourceCtrl.searchText)"
                                    md-item-text="item.name"
                                    placeholder="Search for a property, data stream or command"
                                    md-menu-class="autocomplete-custom-template"
                                    md-selected-item-change="sourceCtrl.change(item)">
                                <md-item-template>
                                <span class="item-title">
                                    <md-icon ng-show="item.type == 'property'" ng-md-icon icon="description"></md-icon>
                                    <md-icon ng-show="item.type == 'datastream'" ng-md-icon icon="group_work"></md-icon>
                                    <md-icon ng-show="item.type == 'command'" ng-md-icon icon="code"></md-icon>
                                    <md-icon ng-show="item.type == 'input'" ng-md-icon icon="text_fields"></md-icon>
                                    <span md-highlight-text="sourceCtrl.searchText">{{item.name}}</span> <i>({{item.type}})</i>
                                </span>
                                <span class="item-metadata">
                                    <span class="item-metastat">{{item.item_name}}</span>
                                    <strong class="item-metastat" ng-show="!!item.value">value = {{item.value}}</strong>
                                </span>
                                </md-item-template>
                            </md-autocomplete>
                            <md-chip-template>
                                <span>
                                    <strong>{{$chip.name}}</strong>
                                    <em>{{$chip.item_name}}</em>
                                </span>
                            </md-chip-template>
                        </md-chips>

                    </div>
                </md-tab-body>
            </md-tab>
            <md-tab>
                <md-tab-label>Transform</md-tab-label>
                <md-tab-body>

                    <div layout="column">

                        <md-card flex="80">
                            <md-card-contents>
                                <div ui-ace="{mode: 'javascript', onChange: dialogCtrl.interpret}" class="transform-edit" ng-model="transform"></div>
                            </md-card-contents>
                        </md-card>

                        <md-card flex="20">
                            <md-card-content>
                                <p>{{transformedValue}}</p>
                            </md-card-content>
                        </md-card>

                    </div>

                </md-tab-body>
            </md-tab>
        </md-tabs>
    </md-dialog-content>
    <md-dialog-actions layout="row">
        <md-button ng-click="dialogCtrl.cancel()" class="md-warn">Cancel</md-button>
        <span flex></span>
        <md-button ng-click="dialogCtrl.hide()" class="md-primary">Ok</md-button>
    </md-dialog-actions>
</md-dialog>