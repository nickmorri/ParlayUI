<md-tab label="Commands">

	<md-toolbar class="md-hue-2">
		<div class="md-toolbar-tools">

			<h5>Command Builder</h5>

			<span flex></span>

            <md-button ng-click="ctrl.toggleCommandBuilder($event)" class="md-icon-button" aria-label="Toggle command builder">
                <md-tooltip>Toggle command builder</md-tooltip>
                <md-icon ng-md-icon icon="{{ctrl.command_builder_collapsed ? 'expand_less' : 'expand_more'}}"></md-icon>
            </md-button>

		</div>
	</md-toolbar>

    <form name="commandform" layout="column" ng-submit="ctrl.send($event)" ng-hide="ctrl.command_builder_collapsed">

        <promenade-standard-item-card-command-container
                class="promenade-item-card-tab-content"
                commandform="commandform"
                wrapper="wrapper"
                fields="ctrl.item.content_fields">
        </promenade-standard-item-card-command-container>

        <div flex layout="row">

            <md-button flex class="md-raised md-primary" type="submit" ng-disabled="commandform.$invalid" aria-label="Sends command to a Promenade Standard Item.">
                Send
            </md-button>

            <div flex layout="row" layout-align="center center">
                <h1 class="md-subhead">Message ID: {{ctrl.item.getMessageId()}}</h1>
            </div>

        </div>

    </form>

    <md-toolbar class="md-hue-2">
        <div class="md-toolbar-tools">

            <h5>Script Builder</h5>

            <span flex></span>

            <md-button ng-click="ctrl.copyCommand($event)" class="md-icon-button" aria-label="Copy command to clipboard">
                <md-tooltip>Copy command to clipboard</md-tooltip>
                <md-icon ng-md-icon icon="content_copy"></md-icon>
            </md-button>

            <md-button ng-click="ctrl.toggleScriptBuilder($event)" class="md-icon-button" aria-label="Toggle script builder">
                <md-tooltip>Toggle script builder</md-tooltip>
                <md-icon ng-md-icon icon="{{ctrl.script_builder_collapsed ? 'expand_less' : 'expand_more'}}"></md-icon>
            </md-button>

        </div>
    </md-toolbar>

    <div layout="column" layout-margin ng-hide="ctrl.script_builder_collapsed">
        <pre class="promenade-script-builder-text">{{wrapper.message.toPythonStatement()}}</pre>
    </div>

    <md-toolbar class="md-hue-2">
        <div class="md-toolbar-tools">

            <h5>Response Contents</h5>

            <span flex></span>

            <md-button ng-click="ctrl.clearResponses($event)" class="md-icon-button" aria-label="Clear responses">
                <md-tooltip>Clear responses</md-tooltip>
                <md-icon ng-md-icon icon="delete"></md-icon>
            </md-button>

            <md-button ng-click="ctrl.toggleResponseContents($event)" class="md-icon-button" aria-label="Toggle response contents">
                <md-tooltip>Toggle response contents</md-tooltip>
                <md-icon ng-md-icon icon="{{ctrl.response_contents_collapsed ? 'expand_less' : 'expand_more'}}"></md-icon>
            </md-button>

        </div>
    </md-toolbar>

    <div layout="column" ng-hide="ctrl.response_contents_collapsed">

        <div ng-show="ctrl.responses.length" layout="column" layout-margin>

            <div layout="row" layout-align="start center" class="promenade-response-contents-body">
                <p flex="15" class="md-body-2">MSG ID</p>
                <span flex="5"></span>
                <p flex ng-hide="response.received" class="md-body-2">Contents</p>
                <span flex="5"></span>
                <p class="md-body-2">Received</p>
            </div>

            <div ng-repeat="response in ctrl.responses">
                <div layout="row" layout-align="start center" class="promenade-response-contents-body">
                    <p flex="15" class="md-body-1">{{response.MSG_ID}}</p>
                    <span flex="5"></span>
                    <p flex ng-hide="response.received" class="md-body-1">Waiting for response..</p>

                    <div flex ng-show="response.received" layout="column">
                        <p flex ng-show="response.received" class="md-body-1 promenade-response-contents-key-values" ng-repeat="(key, value) in response.message.CONTENTS">
                            {{key}} = {{value}}<span ng-show="!$last">,</span>
                        </p>
                    </div>

                    <span flex="5"></span>
                    <md-icon ng-md-icon icon="check" ng-show="response.received"></md-icon>
                    <md-progress-circular ng-hide="response.received" md-mode="indeterminate" md-diameter="30px"></md-progress-circular>
                </div>
            </div>

        </div>

        <div ng-hide="ctrl.responses.length" layout-margin>
            <p class="md-body-1">No response received.</p>
        </div>

    </div>

</md-tab>